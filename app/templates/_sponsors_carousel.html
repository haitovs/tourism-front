{% set tier = data["tier"] %} {% set page = data["page"] %} {% set per = data["per_page"] %} {% set count = data["items"]|length
%}

<div
    x-data
    x-init="
    (() => {
      // Only auto-advance if the page is 'full' -> likely more pages
      if ({{ count }} < {{ per }}) return;
      const go = () => {
        const btn = $refs.nextBtn;
        if (!btn) return;
        btn.click();
      };
      setInterval(go, 10000);
    })()
  "
    class="relative"
>
    <!-- rail (one snap page containing a 2x2 grid) -->
    <div class="overflow-x-auto snap-x snap-mandatory flex gap-4 pb-2">
        <div class="snap-start shrink-0 w-full">
            <div class="grid [grid-template-columns:repeat(2,190px)] justify-center gap-4">
                {% for sp in data["items"] %}
                <article class="bg-white rounded-2xl shadow p-4 flex items-center justify-center w-[190px] h-[225px]">
                    {% if sp.logo_url %}
                    <img
                        src="{{ sp.logo_url }}"
                        alt="{{ sp.name }}"
                        title="{{ sp.name }}"
                        class="w-[150px] h-[150px] object-contain"
                    />
                    {% else %}
                    <img
                        src="/static/img/sponsor_logo.png"
                        alt="Sponsor"
                        title="Sponsor"
                        class="w-[150px] h-[150px] object-contain opacity-70"
                    />
                    {% endif %}
                </article>
                {% else %} {% for _ in range(4) %}
                <div class="bg-white rounded-2xl shadow p-4 w-[190px] h-[225px] animate-pulse"></div>
                {% endfor %} {% endfor %}
            </div>
        </div>
    </div>

    <!-- hidden next trigger for HTMX; we 'click' it via Alpine every 10s -->
    <button
        x-ref="nextBtn"
        class="hidden"
        hx-get="/x/sponsors/{{ tier }}?page={{ page + 1 }}"
        hx-target="#carousel-{{ tier }}"
        hx-swap="outerHTML"
        aria-hidden="true"
        tabindex="-1"
    ></button>
</div>

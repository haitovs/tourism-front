{% extends "base.html" %}{% from "_hero_macros.html" import hero_buttons %}
{% block content %}
{% set sec = sector or expo_sector %}
<main>
    <!-- HERO - uses same image as expo sectors list page -->
    <section class="relative w-full h-[320px] md:h-[380px]">
        <img src="/static/img/expo_sectors_hero.png" alt="" class="absolute inset-0 w-full h-full object-cover" />
        <div class="absolute inset-0 bg-black/40"></div>

        <div class="relative z-[1] h-full flex flex-col items-center justify-center text-center px-4">
            <h1 class="font-['Montserrat'] font-bold text-white text-[clamp(28px,5vw,56px)] leading-tight">
                {{ sec.header if sec and sec.header else t('sectors.detail.hero.section_fallback') }}
            </h1>
            {% if sec and (sec.subtitle or sec.tagline) %}
            <p class="mt-2 font-['Roboto'] text-white/90 text-[clamp(16px,2.4vw,20px)]">
                {{ sec.subtitle or sec.tagline }}
            </p>
            {% endif %}
        </div>

        {{ hero_buttons(
        home_href = '/',
        section_label = t('sectors.detail.hero.section_label'),
        section_href = '/expo-sectors',
        is_detail = True,
        current_path = request.url.path,
        detail_label = t('sectors.detail.hero.detail_label'),
        detail_href = '#sector-body',
        detail_refresh = False
        ) }}
    </section>

    {# ---------- BODY ---------- #}
    <section id="sector-body" class="mx-auto max-w-[1450px] px-4 py-10">
        <div class="bg-white rounded-[20px] shadow-sm p-6 md:p-10">
            {% if sec and sec.header %}
            <h2 class="font-['Montserrat'] font-medium text-[clamp(28px,4.2vw,50px)] leading-[1.22] text-[#1E1E1E]">
                {{ sec.header }}
            </h2>
            {% endif %}

            {% if sec and sec.intro_html %}
            <div
                class="mt-6 text-black text-[25px] leading-[40px] font-['Roboto'] [&_p]:mb-4 [&_ul]:list-disc [&_ul]:pl-6">
                {{ sec.intro_html | safe }}
            </div>
            {% elif sec and sec.description %}
            <p class="mt-6 text-black text-[25px] leading-[40px] font-['Roboto']">{{ sec.description }}</p>
            {% endif %}

            {# ---------- TOP 3 IMAGES ---------- #}
            {% set hero_imgs = sec.images_hero or [] %}
            {% if hero_imgs|length > 0 %}
            <div class="mt-8 grid grid-cols-1 sm:grid-cols-3 gap-6">
                {% for u in hero_imgs[:3] %}
                <div class="mx-auto w-[min(100%,350px)] aspect-square rounded-[16px] overflow-hidden bg-slate-100">
                    <img src="{{ u }}" alt="" class="w-full h-full object-cover" />
                </div>
                {% endfor %}
            </div>
            {% endif %}

            {% if sec and (sec.mid_html or sec.body_html) %}
            <div class="mt-8 text-black text-[25px] leading-[40px] font-['Roboto'] [&_p]:mb-4">
                {{ (sec.mid_html or sec.body_html) | safe }}
            </div>
            {% endif %}

            {% if sec and (sec.points_left or sec.points_right) %}
            <div class="mt-6 grid gap-8 md:grid-cols-2">
                {% if sec.points_left %}
                <div>
                    <h3 class="font-['Roboto'] font-medium text-[25px] leading-[40px] text-black">
                        {{ t('sectors.detail.key_professions') }}
                    </h3>
                    <ul class="mt-1 list-disc pl-6 text-black text-[25px] leading-[40px] font-['Roboto'] space-y-1">
                        {% for item in sec.points_left %}<li>{{ item }}</li>{% endfor %}
                    </ul>
                </div>
                {% endif %}
                {% if sec.points_right %}
                <div>
                    <h3 class="font-['Roboto'] font-medium text-[25px] leading-[40px] text-black">
                        {{ t('sectors.detail.types') }}
                    </h3>
                    <ul class="mt-1 list-disc pl-6 text-black text-[25px] leading-[40px] font-['Roboto'] space-y-1">
                        {% for item in sec.points_right %}<li>{{ item }}</li>{% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
            {% endif %}

            {% if sec and (sec.outro_html or sec.outro) %}
            {% if sec.outro_html %}
            <div class="mt-8 text-black text-[25px] leading-[40px] font-['Roboto'] [&_p]:mb-4">{{ sec.outro_html | safe
                }}</div>
            {% else %}
            <p class="mt-8 text-black text-[25px] leading-[40px] font-['Roboto']">{{ sec.outro }}</p>
            {% endif %}
            {% endif %}

            {# ---------- REST GALLERY - Responsive Masonry with Lightbox ---------- #}
            {% set rest = sec.images_rest or [] %}
            {% if rest|length > 0 %}
            <div class="mt-10">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="gallery-grid">
                    {% for u in rest %}
                    <a href="{{ u }}" class="glightbox block rounded-[20px] overflow-hidden bg-slate-100 
                        {% if loop.index == 1 and rest|length >= 4 %}sm:col-span-2 sm:row-span-2{% endif %}
                        aspect-[4/3] hover:opacity-90 transition-opacity" data-gallery="sector-gallery">
                        <img src="{{ u }}" alt="Gallery image {{ loop.index }}" class="w-full h-full object-cover"
                            loading="lazy" />
                    </a>
                    {% endfor %}
                </div>
            </div>

            <!-- GLightbox CDN -->
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.2.0/dist/css/glightbox.min.css" />
            <script src="https://cdn.jsdelivr.net/npm/glightbox@3.2.0/dist/js/glightbox.min.js"></script>
            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    GLightbox({ selector: '.glightbox', touchNavigation: true, loop: true });
                });
            </script>
            {% endif %}
        </div>
    </section>
</main>
{% endblock %}
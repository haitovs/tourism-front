<!DOCTYPE html>
<html lang="{{ lang or 'en' }}">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>{{ settings.APP_NAME }}</title>

    <style>
        [x-cloak] {
            display: none !important
        }
    </style>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;600&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;700&display=swap" rel="stylesheet" />

    <!-- favicon per site -->
    <link rel="icon" type="image/x-icon" href="{{ theme('img/favicon.ico') }}" />

    <!-- Base CSS -->
    <link rel="stylesheet" href="{{ url_for('static', path='/css/extra.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/css/detailbar.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/css/navpill.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/css/hero.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/css/timer.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='css/sponsors.css') }}" />
    <link rel="stylesheet" href="{{ url_for('static', path='/css/tw.build.css') }}" />

    <!-- Per-site overrides -->
    <link rel="stylesheet" href="{{ theme('css/theme.css') }}" />

    <!-- Splide CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/css/splide.min.css" />
</head>

<body class="flex min-h-screen flex-col bg-[var(--c-bg)] text-[var(--c-text)]">
    {% include themed('_detailbar.html') %}
    <main class="flex-1">{% block content %}{% endblock %}</main>
    {% include themed('_footer.html') %}

    <button id="to-top" type="button" aria-label="Scroll to top" title="Back to top">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M12 18V6" stroke="#F4F4F2" stroke-width="3" stroke-linecap="round" />
            <path d="M6 12l6-6 6 6" stroke="#F4F4F2" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" />
        </svg>
    </button>

    <!-- My JS Files -->
    <script src="{{ url_for('static', path='/js/marquee.js') }}" defer></script>
    <script src="{{ url_for('static', path='/js/headerHide.js') }}" defer></script>
    <script src="{{ url_for('static', path='/js/scrollTop.js') }}" defer></script>
    <script src="{{ url_for('static', path='/js/timerWidget.js') }}" defer></script>
    <script src="{{ url_for('static', path='/js/countup.js') }}" defer></script>
    <script src="{{ url_for('static', path='/js/participantLoader.js') }}" defer></script>

    <!-- HTMX / Alpine -->
    <script src="https://unpkg.com/htmx.org@2.0.3"></script>
    <script defer src="https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://unpkg.com/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <!-- Splide JS (defer) -->
    <script src="https://cdn.jsdelivr.net/npm/@splidejs/splide@4.1.4/dist/js/splide.min.js" defer></script>
    <script
        src="https://cdn.jsdelivr.net/npm/@splidejs/splide-extension-grid@0.4.1/dist/js/splide-extension-grid.min.js"
        defer></script>

    <script>
        window.addEventListener("load", () => {
            if (typeof Splide === "undefined") return;
            document.querySelectorAll(".splide[data-splide]").forEach((el) => {
                const d = el.dataset;
                const count = Number(d.count || "0");
                const cfg = {
                    type: d.type || (count > 1 ? "loop" : "slide"),
                    arrows: false,
                    pagination: false,
                    autoplay: d.autoplay === "true" || (d.autoplay === undefined && count > 1),
                    interval: Number(d.interval || "10000"),
                    pauseOnHover: true,
                    speed: Number(d.speed || "600"),
                    easing: d.easing || "cubic-bezier(0.22,1,0.36,1)",
                    drag: true,
                    gap: d.gap || "1rem",
                };
                if (d.perPage) cfg.perPage = Number(d.perPage);
                if (d.rows || d.cols) {
                    cfg.grid = {
                        rows: Number(d.rows || "1"),
                        cols: Number(d.cols || "1"),
                        gap: { row: d.rowGap || "1rem", col: d.colGap || "1rem" }
                    };
                }
                try { if (d.breakpoints) cfg.breakpoints = JSON.parse(d.breakpoints); } catch { }
                const splide = new Splide(el, cfg);
                if (cfg.grid && window.splide && window.splide.Extensions) splide.mount(window.splide.Extensions);
                else splide.mount();
            });
        });
    </script>
</body>

</html>
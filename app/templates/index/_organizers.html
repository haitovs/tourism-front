{# app/templates/_organizers.html #}
{% set all = (data and data.get('items')) or [] %}
{% set count = all|length %}

<section id="organizers" class="mx-auto w-full max-w-[var(--container)] py-14">
    <div class="w-full">
        <header class="text-center mb-8">
            <div class="flex items-center justify-center gap-4">
                <span class="hidden sm:block h-px w-[60px] bg-[#007A3D]"></span>
                <span class="font-['Montserrat'] text-[clamp(18px,2.8vw,30px)] leading-[1.6] text-[#007A3D]">
                    {{ t('index.organizers.band') }}
                </span>
                <span class="hidden sm:block h-px w-[60px] bg-[#007A3D]"></span>
            </div>
            <h2
                class="font-['Montserrat'] text-[clamp(22px,4vw,50px)] leading-[1.2] font-medium mt-1 text-center text-[#1E1E1E]">
                {{ t('index.organizers.title') }}
            </h2>
        </header>

        {# Organizer card: keep current size/image, add partner-like border/hover/focus #}
        {% macro organizer_card(p) -%}
        <article class="box-border border-2 border-gray-300 hover:border-[var(--c-primary)]
             transition-colors focus-visible:outline-none focus-visible:ring-2
             focus-visible:ring-[var(--c-primary)] focus-visible:ring-offset-2
             bg-white rounded-[5px] 
             w-[clamp(160px,28vw,280px)] h-[clamp(100px,18vw,180px)]
             flex items-center justify-center overflow-hidden">
            {% if p.logo_url %}
            <img src="{{ p.logo_url }}" alt="{{ p.name }}" title="{{ p.name }}"
                class="object-contain select-none pointer-events-none w-full h-full" loading="lazy" />
            {% else %}
            <img src="/static/img/img_placeholder.png" alt="{{ p.name }}" title="{{ p.name }}"
                class="object-contain opacity-70 select-none pointer-events-none w-full h-full" loading="lazy" />
            {% endif %}
        </article>
        {%- endmacro %}

        {% if count == 0 %}
        <div class="text-center text-slate-500">{{ t('index.organizers.none') }}</div>

        {% elif count < 8 %} <div class="w-full">
            <ul
                class="flex flex-wrap justify-center gap-x-[clamp(12px,2.5vw,30px)] gap-y-[clamp(12px,2.5vw,30px)] w-full">
                {% for p in all %}
                <li class="flex justify-center">
                    {% set href = p.website|default('') %}
                    {% if href %}
                    <a href="{{ href }}" target="_blank" rel="noopener noreferrer"
                        class="block focus-visible:outline-none"
                        aria-label="{{ p.name }} {{ t('sponsors.common.opens_new_tab') }}">
                        {{ organizer_card(p) }}
                    </a>
                    {% else %}
                    {{ organizer_card(p) }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
    </div>

    {% else %}
    <div class="marquee" data-marquee data-speed="60" data-min="1" data-respect-rm="false" style="--gap: 1rem">
        <div class="marquee__viewport">
            <ul class="marquee__track">
                {% for p in all %}
                <li class="marquee__item">
                    {% set href = p.website|default('') %}
                    {% if href %}
                    <a href="{{ href }}" target="_blank" rel="noopener noreferrer"
                        class="block focus-visible:outline-none"
                        aria-label="{{ p.name }} {{ t('sponsors.common.opens_new_tab') }}">
                        {{ organizer_card(p) }}
                    </a>
                    {% else %}
                    {{ organizer_card(p) }}
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    {% endif %}
    </div>
</section>
